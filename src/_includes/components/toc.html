<div class="cp-toc">
    {% assign elementsByType = site.elements | sort:"order" | group_by:"type"  %} 
    {% for type in elementsByType %}

      {% if type.name %}
        <a class="cp-toc__link" href="#{{ type.name | slugify }}">{{ type.name | capitalize }}</a>
      {% endif %}

      <ul class="cp-toc__list" >
      {% for entry in type.items %}
        <li class="cp-toc__item">
          <a class="cp-toc__link" href="#{{ entry.title | slugify }}">{{ entry.title }}</a>
        </li>
      {% endfor %}
      </ul>
    {% endfor %}
</div>
  